<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¶•ì œ ì¹´ë“œ API í†µí•© í…ŒìŠ¤íŠ¸</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .festival-card-enhanced {
            border: 1px solid #ddd;
            border-radius: 15px;
            overflow: hidden;
            transition: transform 0.3s;
            height: 100%;
        }
        .festival-card-enhanced:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .festival-flag {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 50px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }
        .festival-weather {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(255,255,255,0.9);
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }
        .festival-currency {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        .festival-image-enhanced {
            height: 250px;
            background-size: cover;
            background-position: center;
            position: relative;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">ğŸŒ API í†µí•© ì¶•ì œ ì¹´ë“œ</h1>
        <div class="row" id="enhancedCards">
            <div class="col-12 text-center">
                <div class="spinner-border text-primary" role="status"></div>
                <p>ì¹´ë“œ ë¡œë”© ì¤‘...</p>
            </div>
        </div>
    </div>

    <script>
        // API ì„¤ì •
        const festivalData = {
            tomatina: {
                id: 'tomatina',
                name: 'ë¼ í† ë§ˆí‹°ë‚˜',
                location: 'ìŠ¤í˜ì¸ ë°œë Œì‹œì•„',
                period: '8ì›” ë§ˆì§€ë§‰ ìˆ˜ìš”ì¼',
                price: 2200000,
                image: 'https://images.unsplash.com/photo-1533174072545-7a4b6ad7a6c3?w=800',
                countryCode: 'es',
                currency: 'EUR',
                city: 'Valencia'
            },
            oktoberfest: {
                id: 'oktoberfest',
                name: 'ì˜¥í† ë²„í˜ìŠ¤íŠ¸',
                location: 'ë…ì¼ ë®Œí—¨',
                period: '9ì›” ì¤‘ìˆœ-10ì›” ì´ˆ',
                price: 2500000,
                image: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800',
                countryCode: 'de',
                currency: 'EUR',
                city: 'Munich'
            },
            carnival: {
                id: 'carnival',
                name: 'ë¦¬ìš° ì¹´ë‹ˆë°œ',
                location: 'ë¸Œë¼ì§ˆ ë¦¬ìš°ë°ìë„¤ì´ë£¨',
                period: '2ì›”-3ì›”',
                price: 2800000,
                image: 'https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?w=800',
                countryCode: 'br',
                currency: 'BRL',
                city: 'Rio de Janeiro'
            }
        };

        // í™˜ìœ¨ ê°€ì ¸ì˜¤ê¸°
        async function getExchangeRate(currency) {
            try {
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/KRW');
                const data = await response.json();
                return data.rates[currency];
            } catch (error) {
                console.error('í™˜ìœ¨ ë¡œë“œ ì‹¤íŒ¨:', error);
                return null;
            }
        }

        // ë‚ ì”¨ ê°€ì ¸ì˜¤ê¸° (OpenWeatherMap - ë°ëª¨ìš©)
        async function getWeather(city) {
            // ì‹¤ì œë¡œëŠ” API í‚¤ê°€ í•„ìš”í•˜ì§€ë§Œ, ë°ëª¨ìš©ìœ¼ë¡œ ì„ì‹œ ë°ì´í„° ë°˜í™˜
            const mockWeather = {
                'Valencia': { temp: 28, icon: 'â˜€ï¸' },
                'Munich': { temp: 18, icon: 'â›…' },
                'Rio de Janeiro': { temp: 32, icon: 'ğŸŒ¤ï¸' }
            };
            return mockWeather[city] || { temp: '--', icon: 'ğŸŒ¡ï¸' };
        }

        // ì¹´ë“œ ìƒì„±
        async function createEnhancedCard(festival) {
            const rate = await getExchangeRate(festival.currency);
            const weather = await getWeather(festival.city);
            
            const localPrice = rate ? (festival.price * rate).toFixed(0) : '--';
            const formattedPrice = new Intl.NumberFormat('ko-KR').format(festival.price);
            
            return `
                <div class="col-md-4 mb-4">
                    <div class="festival-card-enhanced">
                        <div class="festival-image-enhanced" style="background-image: url('${festival.image}')">
                            <img src="https://flagcdn.com/w80/${festival.countryCode}.png" 
                                 alt="${festival.location}" 
                                 class="festival-flag">
                            <div class="festival-weather">
                                ${weather.icon} ${weather.temp}Â°C
                            </div>
                        </div>
                        <div class="p-3">
                            <h4>${festival.name}</h4>
                            <p class="text-muted mb-2">
                                <i class="fas fa-map-marker-alt"></i> ${festival.location}
                            </p>
                            <p class="text-muted mb-2">
                                <i class="fas fa-calendar"></i> ${festival.period}
                            </p>
                            <div class="mt-3">
                                <h5 class="text-primary">â‚©${formattedPrice}</h5>
                                <p class="festival-currency">
                                    ì•½ ${new Intl.NumberFormat().format(localPrice)} ${festival.currency}
                                </p>
                            </div>
                            <button class="btn btn-primary w-100 mt-2">
                                <i class="fas fa-info-circle"></i> ìì„¸íˆ ë³´ê¸°
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // ì¹´ë“œ ë¡œë“œ
        async function loadCards() {
            const container = document.getElementById('enhancedCards');
            container.innerHTML = '';
            
            for (const festival of Object.values(festivalData)) {
                const cardHTML = await createEnhancedCard(festival);
                container.insertAdjacentHTML('beforeend', cardHTML);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', loadCards);
    </script>
</body>
</html>
